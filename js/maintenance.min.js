(()=>{const currentDomain=window.location.hostname;const apiDomain=currentDomain.startsWith("api.")?currentDomain:"api."+currentDomain;const isUserAdmin=()=>{const token=localStorage.getItem("adminToken")||localStorage.getItem("jwt");if(!token)return false;try{const parts=token.split(".");if(parts.length<2)return false;const base64Url=parts[1];const base64=base64Url.replace(/-/g,"+").replace(/_/g,"/");const jsonPayload=decodeURIComponent(atob(base64).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join(""));const payload=JSON.parse(jsonPayload);return payload&&payload.role==="admin"}catch{return false}};const checkMaintenance=async()=>{try{const protocol=window.location.protocol==="https:"?"https:":"http:";const maintenanceUrl=`${protocol}//${apiDomain}/public/maintenance`;console.log("Checking maintenance status at:",maintenanceUrl);const response=await fetch(maintenanceUrl,{method:"GET",mode:"cors"});if(!response.ok){console.warn("Maintenance check failed:",response.status);return}const data=await response.json();if(data&&data.active&&!isUserAdmin()){const message=data.message?`?message=${encodeURIComponent(data.message)}`:"";window.location.replace("/maintenance.html"+message)}}catch(error){console.warn("Maintenance check error:",error)}};checkMaintenance()})();